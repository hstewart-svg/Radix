<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radix | Transformation Architect</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,800&display=swap');
        * { font-family: 'Plus Jakarta Sans', sans-serif !important; }
        body { letter-spacing: 0.025em; background: #fcfdfe; color: #1e293b; }
        .nav-glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(16px); border-bottom: 1px solid #f1f5f9; }
        .card-shadow { box-shadow: 0 15px 35px -12px rgba(0,0,0,0.06); transition: all 0.4s ease; }
        .text-header { font-weight: 800; font-style: italic; letter-spacing: -0.03em; }
        .pill { font-size: 9px; font-weight: 900; padding: 4px 10px; border-radius: 99px; text-transform: uppercase; letter-spacing: 0.1em; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // PRE-DEFINED GEOGRAPHY
        const EUROPE_INVENTORY = [
            "Albania", "Andorra", "Austria", "Belarus", "Belgium", "Bosnia and Herzegovina", "Bulgaria", "Croatia", "Cyprus", "Czech Republic", 
            "Denmark", "Estonia", "Finland", "France", "Germany", "Greece", "Hungary", "Iceland", "Ireland", "Italy", "Latvia", "Liechtenstein", 
            "Lithuania", "Luxembourg", "Malta", "Moldova", "Monaco", "Montenegro", "Netherlands", "North Macedonia", "Norway", "Poland", "Portugal", 
            "Romania", "Russia", "San Marino", "Serbia", "Slovakia", "Slovenia", "Spain", "Sweden", "Switzerland", "Ukraine", "United Kingdom"
        ];

        const GROUPS = {
            "DACH": ["Germany", "Austria", "Switzerland"],
            "Nordic": ["Denmark", "Finland", "Norway", "Sweden", "Iceland"],
            "Benelux": ["Belgium", "Netherlands", "Luxembourg"],
            "UK/IE": ["United Kingdom", "Ireland"]
        };

        const App = () => {
            const [view, setView] = useState('home');
            const [levers, setLevers] = useState({ inCountryRate: 115, coeRate: 45, coeEfficiencyLift: 35 });
            
            const [rcmData, setRcmData] = useState([
                { id: 1, cycle: "P2P", controlName: "PMT-01", country: "Germany", group: "DACH", execH: 120, status: "Local", complexity: 1.0 },
                { id: 2, cycle: "P2P", controlName: "PMT-01", country: "Austria", group: "DACH", execH: 110, status: "Local", complexity: 1.1 }
            ]);

            const updateNode = (id, field, value) => {
                let updatedValue = value;
                let updatedGroup = null;

                // Handle Country selection and auto-mapping to Groups
                if (field === 'country') {
                    Object.entries(GROUPS).forEach(([groupName, countries]) => {
                        if (countries.includes(value)) updatedGroup = groupName;
                    });
                }

                setRcmData(rcmData.map(n => n.id === id ? { 
                    ...n, 
                    [field]: updatedValue,
                    ...(updatedGroup ? { group: updatedGroup } : field === 'country' ? { group: 'Other' } : {}) 
                } : n));
            };

            const stats = useMemo(() => {
                const totalDebt = rcmData.reduce((acc, c) => acc + (c.execH * levers.inCountryRate), 0);
                return { totalDebt };
            }, [rcmData, levers]);

            const StructuralLogo = () => (
                <div className="flex items-center gap-4">
                    <svg width="36" height="36" viewBox="0 0 40 40" fill="none"><rect x="8" y="8" width="6" height="24" rx="1.5" fill="#4F46E5"/><path d="M14 8H24C28.4 8 32 11.6 32 16C32 20.4 28.4 24 24 24H14V8Z" fill="#4F46E5" fillOpacity="0.8"/><path d="M22 24L30 32H22L14 24H22Z" fill="#4F46E5"/></svg>
                    <div className="flex flex-col">
                        <span className="text-2xl text-header text-slate-900 leading-none">Radix</span>
                        <span className="text-[10px] font-bold text-indigo-600 uppercase tracking-[0.2em] mt-1 italic">Transformation Architect</span>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen">
                    <nav className="nav-glass sticky top-0 z-50 px-12 py-6 flex justify-between items-center">
                        <button onClick={() => setView('home')}><StructuralLogo /></button>
                        <div className="flex gap-10">
                            <button onClick={() => setView('home')} className={`text-[11px] font-bold uppercase tracking-widest ${view==='home'?'text-indigo-600 underline underline-offset-[12px] decoration-2':'text-slate-400'}`}>Map</button>
                            <button onClick={() => setView('ingest')} className={`text-[11px] font-bold uppercase tracking-widest ${view==='ingest'?'text-indigo-600 underline underline-offset-[12px] decoration-2':'text-slate-400'}`}>Architect</button>
                        </div>
                    </nav>

                    <main className="max-w-7xl mx-auto p-12 space-y-16">
                        {view === 'home' && (
                            <div className="space-y-12 animate-in fade-in duration-700">
                                <div className="flex justify-between items-end">
                                    <h2 className="text-4xl text-header text-slate-900 italic">Geographic Bifurcation</h2>
                                    <div className="bg-indigo-950 px-8 py-4 rounded-2xl text-white shadow-xl">
                                        <p className="text-[9px] font-bold text-indigo-400 uppercase italic">Local Manual Debt</p>
                                        <p className="text-3xl text-header text-emerald-400 italic">${stats.totalDebt.toLocaleString()}</p>
                                    </div>
                                </div>

                                {/* GROUP VIEW */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    {Object.keys(GROUPS).map(g => (
                                        <div key={g} className="bg-white p-8 rounded-[2.5rem] border border-slate-100 card-shadow">
                                            <span className="pill bg-indigo-50 text-indigo-600 mb-4 inline-block">{g} Group</span>
                                            <h3 className="text-xl text-header text-slate-900 mb-4">{GROUPS[g].join(" + ")}</h3>
                                            <p className="text-xs text-slate-400 font-medium italic">
                                                {rcmData.filter(c => c.group === g).length} Control Nodes identified in cluster.
                                            </p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {view === 'ingest' && (
                            <div className="animate-in slide-in-from-bottom-8 duration-700 space-y-12">
                                <div className="flex justify-between items-end">
                                    <h2 className="text-4xl text-header text-slate-900 italic uppercase tracking-tighter">Bifurcation Architect</h2>
                                    <button 
                                        onClick={() => setRcmData([...rcmData, { id: Date.now(), cycle: "CYCLE", controlName: "NEW-CTRL", country: "Germany", group: "DACH", execH: 40, status: "Local", complexity: 1.0 }])}
                                        className="bg-indigo-600 text-white px-10 py-5 rounded-2xl font-bold uppercase text-[10px] tracking-widest shadow-xl"
                                    >
                                        Add Control DNA
                                    </button>
                                </div>

                                <div className="bg-white rounded-[3.5rem] border border-slate-100 card-shadow overflow-hidden">
                                    <table className="w-full text-left font-medium">
                                        <thead className="bg-slate-50 border-b text-[10px] font-bold text-slate-400 uppercase tracking-widest italic">
                                            <tr>
                                                <th className="px-12 py-10">Control / Cycle</th>
                                                <th className="px-12 py-10">Country Selection</th>
                                                <th className="px-12 py-10">Region DNA</th>
                                                <th className="px-12 py-10 text-right">Strategic Action</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-slate-50">
                                            {rcmData.map((c, i) => (
                                                <tr key={c.id} className="hover:bg-slate-50 transition-all">
                                                    <td className="px-12 py-10">
                                                        <input value={c.controlName} onChange={e => updateNode(c.id, 'controlName', e.target.value)} className="text-xl text-header text-slate-900 bg-transparent outline-none focus:text-indigo-600 italic uppercase" />
                                                        <span className="text-[10px] font-bold text-slate-300 uppercase block mt-1">{c.cycle}</span>
                                                    </td>
                                                    <td className="px-12 py-10">
                                                        {/* POINT & CLICK INVENTORY DROPDOWN */}
                                                        <select 
                                                            value={c.country} 
                                                            onChange={e => updateNode(c.id, 'country', e.target.value)}
                                                            className="bg-slate-50 p-4 rounded-xl text-xs font-black text-slate-700 outline-none border-none ring-1 ring-slate-100 focus:ring-2 focus:ring-indigo-100"
                                                        >
                                                            {EUROPE_INVENTORY.map(country => <option key={country} value={country}>{country}</option>)}
                                                        </select>
                                                    </td>
                                                    <td className="px-12 py-10">
                                                        <span className={`pill ${c.group === 'DACH' ? 'bg-amber-50 text-amber-600' : 'bg-slate-100 text-slate-400'}`}>
                                                            {c.group}
                                                        </span>
                                                    </td>
                                                    <td className="px-12 py-10 text-right">
                                                        <button 
                                                            onClick={() => updateNode(c.id, 'status', c.status === 'Local' ? 'COE' : 'Local')}
                                                            className={`text-[10px] font-black uppercase tracking-widest px-6 py-3 rounded-xl transition-all ${c.status === 'Local' ? 'bg-indigo-600 text-white shadow-lg' : 'bg-emerald-500 text-white shadow-lg'}`}
                                                        >
                                                            {c.status === 'Local' ? 'Shift to COE' : 'Standardized'}
                                                        </button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
